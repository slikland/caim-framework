<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../../source/coffee/slikland/anim/KTween.coffee - Caim Framework</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://slikland.com/media/images/logo_docs.png" title="Caim Framework"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 3.3.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/_.html">_</a></li>
                                <li><a href="../classes/AnimationTicker.html">AnimationTicker</a></li>
                                <li><a href="../classes/API.html">API</a></li>
                                <li><a href="../classes/App.html">App</a></li>
                                <li><a href="../classes/ArrayUtils.html">ArrayUtils</a></li>
                                <li><a href="../classes/AssetLoader.html">AssetLoader</a></li>
                                <li><a href="../classes/BaseAnimation.html">BaseAnimation</a></li>
                                <li><a href="../classes/BaseDOM.html">BaseDOM</a></li>
                                <li><a href="../classes/BaseNavigationController.html">BaseNavigationController</a></li>
                                <li><a href="../classes/BaseView.html">BaseView</a></li>
                                <li><a href="../classes/Caim.html">Caim</a></li>
                                <li><a href="../classes/ColorUtils.html">ColorUtils</a></li>
                                <li><a href="../classes/ConditionsValidation.html">ConditionsValidation</a></li>
                                <li><a href="../classes/CookiesManager.html">CookiesManager</a></li>
                                <li><a href="../classes/DataStorageManager.html">DataStorageManager</a></li>
                                <li><a href="../classes/Debug.html">Debug</a></li>
                                <li><a href="../classes/DefaultNavigationController.html">DefaultNavigationController</a></li>
                                <li><a href="../classes/Detections.html">Detections</a></li>
                                <li><a href="../classes/DOMUtils.html">DOMUtils</a></li>
                                <li><a href="../classes/EventDispatcher.html">EventDispatcher</a></li>
                                <li><a href="../classes/FunctionUtils.html">FunctionUtils</a></li>
                                <li><a href="../classes/GeolocationDetection.html">GeolocationDetection</a></li>
                                <li><a href="../classes/GestureUtils.html">GestureUtils</a></li>
                                <li><a href="../classes/GoogleAnalytics.html">GoogleAnalytics</a></li>
                                <li><a href="../classes/GTM.html">GTM</a></li>
                                <li><a href="../classes/IndexedDB.html">IndexedDB</a></li>
                                <li><a href="../classes/JSONUtils.html">JSONUtils</a></li>
                                <li><a href="../classes/KTween.html">KTween</a></li>
                                <li><a href="../classes/MathUtils.html">MathUtils</a></li>
                                <li><a href="../classes/MediaDOM.html">MediaDOM</a></li>
                                <li><a href="../classes/MetaController.html">MetaController</a></li>
                                <li><a href="../classes/MouseUtils.html">MouseUtils</a></li>
                                <li><a href="../classes/MovieTrackingParser.html">MovieTrackingParser</a></li>
                                <li><a href="../classes/Navigation.html">Navigation</a></li>
                                <li><a href="../classes/NavigationContainer.html">NavigationContainer</a></li>
                                <li><a href="../classes/NavigationLoader.html">NavigationLoader</a></li>
                                <li><a href="../classes/NavigationRouter.html">NavigationRouter</a></li>
                                <li><a href="../classes/NumberUtils.html">NumberUtils</a></li>
                                <li><a href="../classes/ObjectUtils.html">ObjectUtils</a></li>
                                <li><a href="../classes/PreloadFiles.html">PreloadFiles</a></li>
                                <li><a href="../classes/Resizer.html">Resizer</a></li>
                                <li><a href="../classes/ResizeUtils.html">ResizeUtils</a></li>
                                <li><a href="../classes/ScrollNavigationController.html">ScrollNavigationController</a></li>
                                <li><a href="../classes/ShareUtils.html">ShareUtils</a></li>
                                <li><a href="../classes/Shortcut.html">Shortcut</a></li>
                                <li><a href="../classes/SplitTextUtils.html">SplitTextUtils</a></li>
                                <li><a href="../classes/SpriteSheetAnimation.html">SpriteSheetAnimation</a></li>
                                <li><a href="../classes/SRTParser.html">SRTParser</a></li>
                                <li><a href="../classes/StringUtils.html">StringUtils</a></li>
                                <li><a href="../classes/SunUtils.html">SunUtils</a></li>
                                <li><a href="../classes/Tracking.html">Tracking</a></li>
                                <li><a href="../classes/URLUtils.html">URLUtils</a></li>
                                <li><a href="../classes/VideoCanvas.html">VideoCanvas</a></li>
                                <li><a href="../classes/VideoSubtitle.html">VideoSubtitle</a></li>
                                <li><a href="../classes/ViewsData.html">ViewsData</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/slikland.html">slikland</a></li>
                                <li><a href="../modules/slikland.anim.html">slikland.anim</a></li>
                                <li><a href="../modules/slikland.data.html">slikland.data</a></li>
                                <li><a href="../modules/slikland.debug.html">slikland.debug</a></li>
                                <li><a href="../modules/slikland.event.html">slikland.event</a></li>
                                <li><a href="../modules/slikland.loader.html">slikland.loader</a></li>
                                <li><a href="../modules/slikland.media.html">slikland.media</a></li>
                                <li><a href="../modules/slikland.media.subtitles.html">slikland.media.subtitles</a></li>
                                <li><a href="../modules/slikland.media.tracking.html">slikland.media.tracking</a></li>
                                <li><a href="../modules/slikland.media.video.html">slikland.media.video</a></li>
                                <li><a href="../modules/slikland.navigation.core.html">slikland.navigation.core</a></li>
                                <li><a href="../modules/slikland.navigation.display.html">slikland.navigation.display</a></li>
                                <li><a href="../modules/slikland.navigation.types.html">slikland.navigation.types</a></li>
                                <li><a href="../modules/slikland.net.html">slikland.net</a></li>
                                <li><a href="../modules/slikland.tracking.html">slikland.tracking</a></li>
                                <li><a href="../modules/slikland.utils.html">slikland.utils</a></li>
                                <li><a href="../modules/slikland.utils.keyboard.html">slikland.utils.keyboard</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ../../source/coffee/slikland/anim/KTween.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
###*
KTween class

@class KTween
@submodule slikland.anim
###
class KTween
	@tweenTypes = {}
	@numValues = 100
	@inited = false
	@items = []
	@queued = []
	@numQueued = 0
	@numItems = 0
	@index = 0
	@div = 1 / 0xFFFFFF

	@init:(@timeout = 1000 / 60)-&gt;
		if @inited then return
		@initTime = new Date().getTime()
		setInterval @update, @timeout
		@inited = true

	@update:()=&gt;
		t = new Date().getTime() - @initTime
		l = @numQueued
		while l-- &gt; 0
			if @queued[l].initTime &lt;= t
				@numQueued--
				@numItems++
				@queued[l].init()
				@items.push(@queued.splice(l, 1)[0])
		l = @numItems
		while l-- &gt; 0
			comp = false
			ko = @items[l]
			continue if !ko
			tar = ko.target
			tim = (t - (ko.initTime)) * ko.iDuration
			if tim &lt; 0 then tim = 0
			if tim &gt; 1 then tim = 1
			values = @tweenTypes[ko.transition][0]
			diffs = @tweenTypes[ko.transition][1]
			p = tim * @numValues
			ap = p &gt;&gt; 0
			p = (values[ap] + diffs[ap] * (p - ap)) * @div
			lj = ko.numParams
			params = ko.params
			distances = ko.distances
			initValues = ko.initValues
			while lj-- &gt; 0
				tar[params[lj]] = distances[lj] * p + initValues[lj]
			if ko.onUpdate
				params = ko.onUpdateParams
				ko.onUpdate.apply(ko.target, params)
			if tim == 1
				@numItems--
				@items.splice(l, 1)
				if ko.onComplete and ko.onComplete != undefined
					params = ko.onCompleteParams
					if !params
						params = []
					ko.onComplete.apply(ko.target, params)
	
	@tween:(target, params, transition = &quot;linear&quot;, time = 0, delay = 0)-&gt;
		if !@inited then @init()
		if !@tweenTypes[transition] then @populateEasing(transition)
		t = ((new Date().getTime() - @initTime) + delay * 1000) &gt;&gt; 0
		ko = new KTObject(@index++, target, t, (time * 1000) &gt;&gt; 0, params, transition)
		if delay == 0
			ko.init()
			@numItems++
			@items.push(ko)
		else
			@numQueued++
			@queued.push(ko)
		return ko
	
	@populateEasing:(transition)-&gt;
		if (f = KTween[transition])
			values = []
			diffs = []
			l = @numValues
			for i in [0...l]
				p = values[i] = ((f(i, 0, 0xFFFFFF, l) + 0.5) &gt;&gt; 0)
				if i &gt; 0 then diffs[i- 1] = p - lp
				lp = p
			values[l] = 0xFFFFFF
			values[l + 1] = 0
			diffs[l - 1] = 0xFFFFFF - lp
			diffs[l] = 0
			@tweenTypes[transition] = [values, diffs]
	
	@tweenSequence:(target, onComplete, sequence, onCompleteParams = null)-&gt;
		if !target then return
		if !sequence then return
		if sequence.length == 0
			if onComplete then onComplete.apply(target, onCompleteParams)
			return
		o = sequence.shift()
		tr = &#x27;linear&#x27;
		if o[&#x27;transition&#x27;] then tr = o[&#x27;transition&#x27;]
		t = 0
		if o[&#x27;time&#x27;] then t = o[&#x27;time&#x27;]
		d = 0
		if o[&#x27;delay&#x27;] then d = o[&#x27;delay&#x27;]
		@tween(target, o, tr, t, d, tweenSequence, [target, onComplete, sequence, onCompleteParams])
	
	@remove:(target, parameter = null)-&gt;
		l = @numQueued
		while l-- &gt; 0
			q = @queued[l]
			if q.target == target
				if q.remove(parameter)
					@numQueued--
					@queued.splice(l, 1)
		l = @numItems
		while l-- &gt; 0
			q = @items[l]
			if q.target == target
				if q.remove(parameter)
					@numItems--
					@items.splice(l, 1)
	
	@getByTime:(type, time, duration)-&gt;
		values = @tweenTypes[type]
		p = (time / duration) * @numValues
		ap = p &gt;&gt; 0
		p1 = values[ap]
		p2 = values[ap + 1]
		return (p2 - p1) * (p - ap) + p1

	@getByPosition:(type, position)-&gt;
		if !@inited then @init()
		if !@tweenTypes[type] then @populateEasing(type)
		values = @tweenTypes[type][0]
		diffs = @tweenTypes[type][1]
		position *= @numValues
		ap = position &gt;&gt; 0
		return (values[ap] + diffs[ap] * (position - ap)) * @div
	
	##--------------------------------------
	##	Rober Penner easing functions
	##--------------------------------------
	@linear:(t, b, c, d, p_params = null)-&gt;
		return c * t / d + b

	@easeInQuad:(t, b, c, d, p_params = null)-&gt;
		return c * (t /= d) * t + b

	@easeOutQuad:(t, b, c, d, p_params = null)-&gt;
		return -c * (t /= d) * (t - 2) + b

	@easeInOutQuad:(t, b, c, d, p_params = null)-&gt;
		if ((t /= d / 2) &lt; 1) then return c / 2 * t * t + b
		return -c / 2 * ((--t) * (t - 2) - 1) + b

	@easeOutInQuad:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutQuad(t * 2, b, c / 2, d, p_params)
		return @easeInQuad((t * 2) - d, b + c / 2, c / 2, d, p_params)

	@easeInCubic:(t, b, c, d, p_params = null)-&gt;
		return c * (t /= d) * t * t + b

	@easeOutCubic:(t, b, c, d, p_params = null)-&gt;
		return c * ((t = t / d - 1) * t * t + 1) + b

	@easeInOutCubic:(t, b, c, d, p_params = null)-&gt;
		if ((t /= d / 2) &lt; 1) then return c / 2 * t * t * t + b
		return c / 2 * ((t -= 2) * t * t + 2) + b

	@easeOutInCubic:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutCubic(t * 2, b, c / 2, d, p_params)
		return @easeInCubic((t * 2) - d, b + c / 2, c / 2, d, p_params)

	@easeInQuart:(t, b, c, d, p_params = null)-&gt;
		return c * (t /= d) * t * t * t + b

	@easeOutQuart:(t, b, c, d, p_params = null)-&gt;
		return -c * ((t = t / d - 1) * t * t * t - 1) + b

	@easeInOutQuart:(t, b, c, d, p_params = null)-&gt;
		if ((t /= d / 2) &lt; 1) then return c / 2 * t * t * t * t + b
		return -c / 2 * ((t -= 2) * t * t * t - 2) + b

	@easeOutInQuart:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutQuart(t * 2, b, c / 2, d, p_params)
		return @easeInQuart((t * 2) - d, b + c / 2, c / 2, d, p_params)

	@easeInQuint:(t, b, c, d, p_params = null)-&gt;
		return c * (t /= d) * t * t * t * t + b

	@easeOutQuint:(t, b, c, d, p_params = null)-&gt;
		return c * ((t = t / d - 1) * t * t * t * t + 1) + b

	@easeInOutQuint:(t, b, c, d, p_params = null)-&gt;
		if ((t /= d / 2) &lt; 1) then return c / 2 * t * t * t * t * t + b
		return c / 2 * ((t -= 2) * t * t * t * t + 2) + b

	@easeOutInQuint:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutQuint(t * 2, b, c / 2, d, p_params)
		return @easeInQuint((t * 2) - d, b + c / 2, c / 2, d, p_params)

	@easeInSine:(t, b, c, d, p_params = null)-&gt;
		return -c * Math.cos(t / d * (Math.PI / 2)) + c + b

	@easeOutSine:(t, b, c, d, p_params = null)-&gt;
		return c * Math.sin(t / d * (Math.PI / 2)) + b

	@easeInOutSine:(t, b, c, d, p_params = null)-&gt;
		return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b

	@easeOutInSine:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutSine(t * 2, b, c / 2, d, p_params)
		return @easeInSine((t * 2) - d, b + c / 2, c / 2, d, p_params)

	@easeInExpo:(t, b, c, d, p_params = null)-&gt;
		if t == 0 then return b
		return c * Math.pow(2, 10 * (t / d - 1)) + b - c * 0.001

	@easeOutExpo:(t, b, c, d, p_params = null)-&gt;
		if t == d then return b + c
		return c * 1.001 * (-Math.pow(2, -10 * t / d) + 1) + b

	@easeInOutExpo:(t, b, c, d, p_params = null)-&gt;
		if (t == 0) then return b
		if (t == d) then return b + c
		if ((t /= d / 2) &lt; 1) then return c / 2 * Math.pow(2, 10 * (t - 1)) + b - c * 0.0005
		return c / 2 * 1.0005 * (-Math.pow(2, -10 * --t) + 2) + b

	@easeOutInExpo:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutExpo(t * 2, b, c / 2, d, p_params)
		return @easeInExpo((t * 2) - d, b + c / 2, c / 2, d, p_params)

	@easeInCirc:(t, b, c, d, p_params = null)-&gt;
		return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b

	@easeOutCirc:(t, b, c, d, p_params = null)-&gt;
		return c * Math.sqrt(1 - (t = t / d - 1) * t) + b

	@easeInOutCirc:(t, b, c, d, p_params = null)-&gt;
		if ((t /= d / 2) &lt; 1) then return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b
		return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b

	@easeOutInCirc:(t, b, c, d, p_params = null)-&gt;
		if (t &lt; d / 2) then return @easeOutCirc(t * 2, b, c / 2, d, p_params)
		return @easeInCirc((t * 2) - d, b + c / 2, c / 2, d, p_params)
		
	@easeInBack: (time,begin,change,duration,overshoot=1.70158) -&gt;
		change*(time/=duration)*time*((overshoot+1)*time - overshoot) + begin;
		
	@easeOutBack: (time,begin,change,duration,overshoot=1.70158) -&gt;
		change*((time=time/duration-1)*time*((overshoot+1)*time + overshoot) + 1) + begin
	
	@easeInOutBack: (time,begin,change,duration,overshoot=1.70158) -&gt;
		if ((time = time/(duration/2)) &lt; 1)
			return change/2*(time*time*(((overshoot*=(1.525))+1)*time - overshoot)) + begin
		else
			return change/2*((time-=2)*time*(((overshoot*=(1.525))+1)*time + overshoot) + 2) + begin

class KTObject
	
	constructor:(@id, @target, @initTime, @duration, params, @transition)-&gt;
		@iDuration = 1 / @duration
		@params = []
		@endValues = []
		@distances = []
		@initValues = []
		@numParams = 0
		@onComplete = params[&#x27;onComplete&#x27;]
		@onCompleteParams = params[&#x27;onCompleteParams&#x27;]
		@onUpdate = params[&#x27;onUpdate&#x27;]
		@onUpdateParams = params[&#x27;onUpdateParams&#x27;]
		@onInit = params[&#x27;onInit&#x27;]
		delete params[&#x27;onComplete&#x27;]
		delete params[&#x27;onCompleteParams&#x27;]
		delete params[&#x27;onUpdate&#x27;]
		delete params[&#x27;onInit&#x27;]
		for p of params
			if @target.hasOwnProperty(p)
				@params.push(p)
				@endValues.push(Number(params[p]))
				@distances.push(0)
				@initValues.push(0)
				@numParams++

	remove:(parameter = null)-&gt;
		disp = true
		if parameter
			l = @numParams
			while l-- &gt; 0
				if @params[l] == parameter
					@params.splice(l, 1)
					@endValues.splice(l, 1)
					@distances.splice(l, 1)
					@initValues.splice(l, 1)
					@numParams--
			disp = (numParams &lt;= 0)
		if disp
			@dispose()
			return true
		return false

	dispose:()-&gt;
		@target = null
		@transition = null
		@onComplete = null
		@onCompleteParams = null
		@params = null
		@endValues = null
		@distances = null
		@initValues = null
		
		delete @target
		delete @transition
		delete @onComplete
		delete @onCompleteParams
		delete @params
		delete @endValues
		delete @distances
		delete @initValues

	init:()-&gt;
		if @onInit
			@onInit.apply(@target)
		l = @numParams
		while l-- &gt;= 0
			p = @initValues[l] = Number(@target[@params[l]])
			@distances[l] = @endValues[l] - p

window.KTween = KTween

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
