<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../../source/coffee/slikland/event/EventDispatcher.coffee - Slikland Framework</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://slikland.com/media/images/logo_docs.png" title="Slikland Framework"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AnimationTicker.html">AnimationTicker</a></li>
                                <li><a href="../classes/ArrayUtils.html">ArrayUtils</a></li>
                                <li><a href="../classes/BaseAnimation.html">BaseAnimation</a></li>
                                <li><a href="../classes/BaseDOM.html">BaseDOM</a></li>
                                <li><a href="../classes/BaseNavigationController.html">BaseNavigationController</a></li>
                                <li><a href="../classes/BaseView.html">BaseView</a></li>
                                <li><a href="../classes/Caim.html">Caim</a></li>
                                <li><a href="../classes/ColorUtils.html">ColorUtils</a></li>
                                <li><a href="../classes/ConditionsValidation.html">ConditionsValidation</a></li>
                                <li><a href="../classes/Debug.html">Debug</a></li>
                                <li><a href="../classes/Detections.html">Detections</a></li>
                                <li><a href="../classes/EventDispatcher.html">EventDispatcher</a></li>
                                <li><a href="../classes/MetaController.html">MetaController</a></li>
                                <li><a href="../classes/Navigation.html">Navigation</a></li>
                                <li><a href="../classes/NavigationContainer.html">NavigationContainer</a></li>
                                <li><a href="../classes/NavigationLoader.html">NavigationLoader</a></li>
                                <li><a href="../classes/NavigationRouter.html">NavigationRouter</a></li>
                                <li><a href="../classes/PreloadFiles.html">PreloadFiles</a></li>
                                <li><a href="../classes/Prototypes.html">Prototypes</a></li>
                                <li><a href="../classes/SpriteSheetAnimation.html">SpriteSheetAnimation</a></li>
                                <li><a href="../classes/StringUtils.html">StringUtils</a></li>
                                <li><a href="../classes/ViewsData.html">ViewsData</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ../../source/coffee/slikland/event/EventDispatcher.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
#import slikland.utils.Prototypes
###*
EventDispatcher class for handling and triggering events.
@class EventDispatcher
###
class EventDispatcher

	# Collection of {Event}
	_events:null

	###*
	Add a event listener.
	@method on
	@param {String} event Event name.
	@param {function} handler A callback function to handle the event.&lt;br&gt;
	The callback function can receive 1 or 2 parameters. The first parameter is the event data itself and the second parameter is the custom data of the triggering event.

	@example
		function someEventHandler(e, data)
		{
			console.log(e); // Returns event data with it&#x27;s type and target/currentTarget set to the scope
			console.log(data); // If the triggering event has any custom data
		}
		var ed = new EventDispatcher()
		ed.on(&#x27;someEvent&#x27;, someEventHandler);
	###
	on:(p_event, p_handler)-&gt;
		if !@_events then @_events = {}
		if !@_events[p_event] then @_events[p_event] = []
		if !(p_handler in @_events[p_event])
			@_events[p_event].unshift(p_handler)

	###*
	Remove an event listener.

	**BEWARE**

	&gt; Calling this method without a handler will remove all listeners attached to this event.

	&gt; If calling without the event name, will remove all listeners attached to this instance.

	@method off
	@param {String} [event=null] Event name.
	@param {function} [handler=null]
	A callback function added in the {{#crossLink &quot;EventDispatcher/on:method&quot;}}{{/crossLink}} call.
	###
	off:(p_event=null, p_handler=null)-&gt;
		if !@_events
			@_events = {}
			return
		if p_event? &amp;&amp; Boolean(@_events[p_event])
			events = @_events[p_event]
			if !p_handler
				@_events[p_event].length = 0
			else
				while (i = events.indexOf(p_handler)) &gt;= 0
					events.splice(i, 1)
				@_events[p_event] = events
		else
			@_events = {}

	###*
	Triggers an event.
	@method trigger
	@param {String} event Event name.
	@param {object} [data=null] Custom event data.
	@param {object} [target=null] Target that will be specified in the &#x60;event.target&#x60;. The &#x60;event.currentTarget&#x60; will always be this instance.

	@example
		var ed = new EventDispatcher()

		// Will just trigger the event
		ed.trigger(&#x27;someEvent&#x27;); 

		// Will trigger the event with the object which can be retrieved by the second
		// parameter of the handler function.
		ed.trigger(&#x27;someEvent&#x27;, {someData: true}); 

		// Will set the event target to window. On the handler&#x27;s first parameter
		//&#x60;event.target&#x60; will be window, and event.currentTarget will be the &#x60;ev&#x60; instance.
		ed.trigger(&#x27;someEvent&#x27;, {someData: true}, window);
	###
	trigger:(evt, data = null, target = null, sourceEvent = null)=&gt;
		if Array.isArray(evt)
			for e in evt
				@trigger(evt, data)
			return
		if !@_events
			@_events = {}
		events = @_events[evt]
		if !events || events.length == 0
			return
		if !target
			target = @

		if sourceEvent instanceof Event or sourceEvent instanceof CustomEvent
			data ?= {}
			data.sourceEvent = sourceEvent

		e = {type: evt, target: target, currentTarget: @, defaultPrevented: false, sourceEvent: sourceEvent || data?.sourceEvent}
		e.preventDefault = ()-&gt;
			@defaultPrevented = true
			@sourceEvent?.preventDefault?()
		e.stopPropagation = ()-&gt;
			sourceEvent?.stopPropagation?()
		e.stopImmediatePropagation = ()-&gt;
			sourceEvent?.stopImmediatePropagation?()

		if typeof(data) == &#x27;object&#x27;
			for k, v of data
				if !e[k]
					e[k] = v
		i = events.length
		while i-- &gt; 0
			events[i]?(e, data)
		return e

	###*
	Check if a event handler is already set.
	@method hasEvent
	@param {String} event Event name.
	@param {function} [handler=null] A callback function added in the {{#crossLink &quot;EventDispatcher/on:method&quot;}}{{/crossLink}} call.
	@return {Boolean}
	###
	hasEvent:(p_event, p_handler)-&gt;
		if !@_events
			@_events = {}
			return

		for event of @_events
			if event is p_event
				if @_events[event].indexOf(p_handler) &gt; -1
					return true
		return false

	###*
	Triggers an event after the current code block has finished processing.

	This is useful for stacking up events that needs to be triggered at the end of the function but it&#x27;s validating beforehand.
	@method stackTrigger
	@param {String} event Event name.
	@param {object} [data=null] Custom event data.
	@param {object} [target=null] Target that will be specified in the &#x60;event.target&#x60;. The &#x60;event.currentTarget&#x60; will always be this instance.

	@example
		var ed = new EventDispatcher()

		var someObject = {a: true, b: false, c: true};

		ed.on(&#x27;isA&#x27;, function(){console.log(&#x27;Is A!&#x27;);});
		ed.on(&#x27;isB&#x27;, function(){console.log(&#x27;Is B!&#x27;);});
		ed.on(&#x27;isC&#x27;, function(){console.log(&#x27;Is C!&#x27;);});

		function test()
		{
			console.log(&quot;Init test()&quot;);
			if(someObject.a) ed.stackTrigger(&#x27;isA&#x27;);
			if(someObject.b) ed.stackTrigger(&#x27;isB&#x27;);
			if(someObject.c) ed.stackTrigger(&#x27;isC&#x27;);
			console.log(&quot;End test()&quot;);
		}

		// This will result in:
		// log: &#x27;Init test()&#x27;
		// log: &#x27;End test()&#x27;
		// log: &#x27;isA&#x27;
		// log: &#x27;isC&#x27;

	###
	stackTrigger:(evt, data = null, target = null)-&gt;
		if !@_stackTriggerer
			@_stackTriggerer = []
		@_stackTriggerer.push([evt, data, target])

		clearTimeout(@_stackTriggerTimeout)
		@_stackTriggerTimeout = setTimeout(@_triggerStacked, 0)
	
	_triggerStacked:()=&gt;
		l = @_stackTriggerer.length
		i = -1
		while ++i &lt; l
			@trigger.apply(@, @_stackTriggerer[i])

		@_stackTriggerer.length = 0
	

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
