<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../../source/coffee/slikland/display/BaseDOM.coffee - Slikland Framework</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://slikland.com/media/images/logo_docs.png" title="Slikland Framework"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AnimationTicker.html">AnimationTicker</a></li>
                                <li><a href="../classes/ArrayUtils.html">ArrayUtils</a></li>
                                <li><a href="../classes/BaseAnimation.html">BaseAnimation</a></li>
                                <li><a href="../classes/BaseDOM.html">BaseDOM</a></li>
                                <li><a href="../classes/BaseNavigationController.html">BaseNavigationController</a></li>
                                <li><a href="../classes/BaseView.html">BaseView</a></li>
                                <li><a href="../classes/Caim.html">Caim</a></li>
                                <li><a href="../classes/ColorUtils.html">ColorUtils</a></li>
                                <li><a href="../classes/ConditionsValidation.html">ConditionsValidation</a></li>
                                <li><a href="../classes/Debug.html">Debug</a></li>
                                <li><a href="../classes/Detections.html">Detections</a></li>
                                <li><a href="../classes/EventDispatcher.html">EventDispatcher</a></li>
                                <li><a href="../classes/MetaController.html">MetaController</a></li>
                                <li><a href="../classes/Navigation.html">Navigation</a></li>
                                <li><a href="../classes/NavigationContainer.html">NavigationContainer</a></li>
                                <li><a href="../classes/NavigationLoader.html">NavigationLoader</a></li>
                                <li><a href="../classes/NavigationRouter.html">NavigationRouter</a></li>
                                <li><a href="../classes/PreloadFiles.html">PreloadFiles</a></li>
                                <li><a href="../classes/Prototypes.html">Prototypes</a></li>
                                <li><a href="../classes/SpriteSheetAnimation.html">SpriteSheetAnimation</a></li>
                                <li><a href="../classes/StringUtils.html">StringUtils</a></li>
                                <li><a href="../classes/ViewsData.html">ViewsData</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ../../source/coffee/slikland/display/BaseDOM.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
#import slikland.utils.Prototypes
#import slikland.event.EventDispatcher

# 
# Helper for adding BaseDOM into any DOM element
# 
# TODO: FIX IE8+
# 
Node::__appendChild__ = Node::appendChild
Node::appendChild = (node) -&gt;
	el = node
	if node instanceof BaseDOM
		el = node.element
		node.parent = @
	Node::__appendChild__.call(@, el)

Node::__removeChild__ = Node::removeChild
Node::removeChild = (node) -&gt;
	el = node
	if node instanceof BaseDOM
		el = node.element
		node.parent = @
	Node::__removeChild__.call(@, el)
Element::matches = Element::matches || Element::webkitMatchesSelector || Element::mozMatchesSelector || Element::msMatchesSelector || Element::oMatchesSelector
Node::findParents = (query) -&gt;
	if @parentNode?
		if @parentNode.matches(query)
			return @parentNode
		else
			return @parentNode.findParents(query)
	return null

# 
# TODO: FIX IE8+
# Node.get({instance: ()-&gt; return @__instance__})

# BaseDOM: SlikLand DOM
###*
Base DOM manipulation class
@class BaseDOM
###

class BaseDOM extends EventDispatcher
	# 
	# Deprecated params: constructor:(element = &#x27;div&#x27;, className = null, namespace = null)-&gt;
	# 
	constructor:(p_options...)-&gt;
		super
		# 
		# Default params:
		# 
		element = &#x27;div&#x27;
		className = null
		namespace = null

		if typeof(p_options[0]) == &#x27;string&#x27; || p_options[0] instanceof HTMLElement
			element = p_options[0]
		else

			i = p_options.length
			while i--
				option = p_options[i]
				if option.element? then element = option.element
				if option.className? then className = option.className
				if option.namespace? then namespace = option.namespace
		if typeof(element) == &#x27;string&#x27;
			if namespace
				@_namespace = namespace
				@_element = document.createElementNS(@_namespace, element)
			else
				@_element = document.createElement(element)
		else if element instanceof HTMLElement
			@_element = element
		if className
			@addClass(className)
		@_element.__instance__ = @


	##------------------------------------------------------------------------------
	##
	##	GETTER / SETTER
	##
	##------------------------------------------------------------------------------

	##--------------------------------------
	##	Base element getter. Read-only
	##--------------------------------------
	@get element: ()-&gt;
		return @_element

	##--------------------------------------
	##	Base namespace getter. Read-only
	##--------------------------------------
	@get namespace: ()-&gt;
		return @_namespace

	##--------------------------------------
	##	Childnodes array
	##--------------------------------------
	@get childNodes:()-&gt;
		return @element.childNodes

	##--------------------------------------
	##	Instance bounds. Only getters.
	##	If changing size, use CSS.
	##--------------------------------------

	@get width:()-&gt;
		return @getBounds().width
	@get height:()-&gt;
		return @getBounds().height
	
	@get left:()-&gt;
		return @getBounds().left
	@get top:()-&gt;
		return @getBounds().top

	@get x:()-&gt;
		return @getBounds().left
	@get y:()-&gt;
		return @getBounds().top


	##--------------------------------------
	##	Parent instance. Can be HTMLElement
	##--------------------------------------
	@get parent: ()-&gt;
		return @_parent

	@set parent: (value)-&gt;
		if !(value instanceof BaseDOM) &amp;&amp; !(value instanceof Node)
			throw new Error(&#x27;Parent instance is not either Node or BaseDOM&#x27;)
		return @_parent = value

	##--------------------------------------
	##	CSS Class Name
	##--------------------------------------
	@get className:()-&gt;
		return @element.className

	@set className:(value)-&gt;
		@element.className = value.trim()

	@get text:()-&gt;
		return @html
	@set text:(value)-&gt;
		@html = value

	##--------------------------------------
	##	InnerHTML
	##--------------------------------------
	@get html:()-&gt;
		return @element.innerHTML
	@set html:(value)-&gt;
		@element.innerHTML = value


	##--------------------------------------
	##	DOM Manipulation
	##--------------------------------------

	@get isAttached:()-&gt;
		return document.contains?(@element) || document.body.contains(@element)

	@get attributes:()-&gt;
		return @element.attributes

	appendChild:(child)-&gt;
		@appendChildAt(child)

	appendChildAt:(child, index = -1)-&gt;
		el = child
		if child instanceof BaseDOM
			el = child.element
		if index == -1 || index &gt;= @childNodes.length
			@element.appendChild(el)
		else
			@element.insertBefore(el, @childNodes[index])
		if child instanceof BaseDOM
			child.parent = @
		return child

	remove:()-&gt;
		@parent?.removeChild?(@)

	removeChild:(child)-&gt;
		el = child
		if child instanceof BaseDOM
			el = child.element
		try
			return @element.removeChild(el)

	removeChildAt:(index = -1)-&gt;
		if index &lt; @childNodes.length
			return @removeChild(@childNodes[i])

	removeAll:()-&gt;
		childs = @childNodes
		i = childs.length
		while i-- &gt; 0
			@removeChild(childs[i])

	##--------------------------------------
	##	Check if the instance matches a query selector
	##--------------------------------------
	matches:(query)-&gt;
		return @element.matches(query)
	##--------------------------------------
	##	Find parent nodes for a matching query selector
	findParents:(query)-&gt;
		return @element.findParents(query)
	##--------------------------------------
	##	Query selector
	##	@onlyInstances: If return only BaseDOM instances
	##--------------------------------------
	find:(query, onlyInstances = false)-&gt;
		element = @element.querySelector(query)
		if onlyInstances
			return element?.__instance__
		else
			return element

	##--------------------------------------
	##	Query selector find all
	##	@onlyInstances: If return only BaseDOM instances
	##--------------------------------------
	findAll:(query, onlyInstances = false)-&gt;
		elements = @element.querySelectorAll(query)
		if onlyInstances
			els = []
			i = -1
			l = elements.length
			p = 0
			while ++i &lt; l
				if elements[i].__instance__
					els[p++] = elements[i].__instance__
			elements = els
		return elements

	##--------------------------------------
	##	Set / Get element attribute
	##	Accepts object:
	##	@example:
	##	attr({id: 1, name: 2})
	##--------------------------------------
	attr:(name, value = &#x27;nonenonenone&#x27;, namespace = false)-&gt;
		if typeof(name) == &#x27;string&#x27;
			return @_attr(name, value, namespace)
		else if typeof(name) == &#x27;object&#x27;
			for k, v of name
				@_attr(k, v, namespace)

	_attr:(name, value = &#x27;nonenonenone&#x27;, namespace = false)-&gt;
		if namespace is false
			namespace = @namespace

		# Default valus is &#x27;nonenonenone&#x27; because of when setting null or false
		if value != &#x27;nonenonenone&#x27;
			if namespace
				@element.setAttributeNS(namespace, name, value)
			else
				@element.setAttribute(name, value)
		if namespace
			return @element.getAttributeNS(namespace, name)
		else
			return @element.getAttribute(name)

	##--------------------------------------
	##	Set / Get element CSS
	##	Accepts object:
	##	@example:
	##	css({color: 1, width: 2})
	##--------------------------------------
	_css:(name, value = null)-&gt;
		if value isnt null
			@element.style[name] = value
		return @element.style[name]

	css:(name, value = null)-&gt;
		if typeof(name) == &#x27;string&#x27;
			return @_css(name, value)
		else if typeof(name) == &#x27;object&#x27;
			for k, v of name
				@_css(k, v)

	##--------------------------------------
	##	CSS Class name manipulation
	##--------------------------------------

	addClass:(className)-&gt;
		if typeof(className) is &#x27;string&#x27;
			className = className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		else if typeof(className) isnt &#x27;Array&#x27;
			return

		classNames = @className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		p = classNames.length
		i = className.length
		while i-- &gt; 0
			if classNames.indexOf(className[i]) &gt;= 0
				continue
			classNames[p++] = className[i]
		@className = classNames.join(&#x27; &#x27;)


	removeClass:(className)-&gt;
		if typeof(className) is &#x27;string&#x27;
			className = className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		else if typeof(className) isnt &#x27;Array&#x27;
			return

		classNames = @className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		i = className.length
		while i-- &gt; 0
			if (p = classNames.indexOf(className[i])) &gt;= 0
				classNames.splice(p, 1)
		@className = classNames.join(&#x27; &#x27;)

	toggleClass:(className, toggle = null)-&gt;
		if toggle isnt null
			if toggle
				@addClass(className)
			else
				@removeClass(className)
			return
		if typeof(className) is &#x27;string&#x27;
			className = className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		else if typeof(className) isnt &#x27;Array&#x27;
			return
		i = className.length
		while i-- &gt; 0
			if @hasClass(className[i])
				@removeClass(className[i])
			else
				@addClass(className[i])
	hasClass:(className)-&gt;
		if typeof(className) is &#x27;string&#x27;
			className = className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		else if typeof(className) isnt &#x27;Array&#x27;
			return

		classNames = @className.replace(/\s+/ig, &#x27; &#x27;).split(&#x27; &#x27;)
		i = className.length

		hasClass = true

		while i-- &gt; 0
			hasClass &amp;= (classNames.indexOf(className[i]) &gt;= 0)
		return hasClass
		

	##--------------------------------------
	##	Get elements bounds as rectangle.
	##	{top, left, bottom, right, width, height}
	##--------------------------------------
	getBounds:(target = null)-&gt;
		boundsObj = {}
		bounds = @element.getBoundingClientRect()
		for k, v of bounds
			boundsObj[k] = v
		if target
			if (target instanceof BaseDOM)
				tbounds = target.getBounds()
			else if (target instanceof HTMLElement)
				tbounds = target.getBoundingClientRect()
		if tbounds
			boundsObj.top -= tbounds.top
			boundsObj.left -= tbounds.left
			boundsObj.bottom -= tbounds.top
			boundsObj.right -= tbounds.left
		boundsObj.width = boundsObj.right - boundsObj.left
		boundsObj.height = boundsObj.bottom - boundsObj.top

		return boundsObj

	destroy:()-&gt;
		@off?()
		@remove?()

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
